
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-08-31
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Constructing Datasets | aloha</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/docs.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />


		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="stylesheet" href="../css/highlight/github.css"/>
	</head>

	<body class="page-eg-dataset project-aloha" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="../index.html"><span class="color-highlight">Aloha</span></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="http://github.com/eharmony/aloha/" title="Code" class="externalLink">Code</a></li>
							<li ><a href="../model_formats.html" title="Model Formats">Model Formats</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dataset Examples <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="dataset/csv.html" title="CSV">CSV</a></li>
									<li ><a href="dataset/vw.html" title="VW Unlabeled">VW Unlabeled</a></li>
									<li ><a href="dataset/labeled_vw.html" title="VW Labeled">VW Labeled</a></li>
									<li ><a href="dataset/cb_vw.html" title="VW Bandit">VW Bandit</a></li>
									<li ><a href="dataset/libsvm.html" title="LIBSVM Unlabeled">LIBSVM Unlabeled</a></li>
									<li ><a href="dataset/labeled_libsvm.html" title="LIBSVM Labeled">LIBSVM Labeled</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar" data-spy="affix" data-offset-top="40">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#toc-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="nav-collapse collapse" id="toc-nav-collapse">
						<ul id="toc" class="nav">
						<li class="toplevel"><a href="#constructing_datasets" title="Constructing Datasets">Constructing Datasets</a></li>
						<li class="dropdown">
							<a href="#By_Command_Line_Interface_CLI" title="By Command Line Interface (CLI)" class="dropdown-toggle" role="button" data-toggle="dropdown" data-target="#">By Command Line Interface (CLI) <b class="caret"></b></a>
							<ul class="dropdown-menu" role="menu">
								<!-- Repeat the item, otherwise it is not clickable as the dropdown root -->
								<li><a href="#By_Command_Line_Interface_CLI" title="By Command Line Interface (CLI)">By Command Line Interface (CLI)</a></li>
								<li class="divider"></li>
								<li class="dropdown-submenu">
									<a href="#Prerequisites" title="Prerequisites">Prerequisites</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#Get_CLI_Jar" title="Get CLI Jar">Get CLI Jar</a></li>
								<li><a href="#Copy_the_CLI_script_to_some_place_your_system_path" title="Copy the CLI script to some place your system path">Copy the CLI script to some place your system path</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Getting_Acquainted" title="Getting Acquainted">Getting Acquainted</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#Checking_Out" title="Checking Out">Checking Out</a></li>
								<li><a href="#Building" title="Building">Building</a></li>
								<li><a href="#A_Look_at_the_CLI" title="A Look at the CLI">A Look at the CLI</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#CSV_Input_Transformed_CSV_output" title="CSV Input, Transformed CSV output">CSV Input, Transformed CSV output</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#Command_and_Results" title="Command and Results">Command and Results</a></li>
								<li><a href="#Files" title="Files">Files</a></li>

									</ul>
								</li>

							</ul>
						</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
				<div class="page-header">
 <h1 id="constructing_datasets">Constructing Datasets</h1>
</div> 
<div class="section"> 
 <h2 id="By_Command_Line_Interface_CLI">By Command Line Interface (CLI)</h2> 
 <div class="section"> 
  <h3 id="Prerequisites">Prerequisites</h3> 
  <div class="section"> 
   <h4 id="Get_CLI_Jar">Get CLI Jar</h4> 
   <p><button>Download the CLI Jar from </button></p> 
  </div> 
  <div class="section"> 
   <h4 id="Copy_the_CLI_script_to_some_place_your_system_path">Copy the CLI script to some place your system path</h4> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Getting_Acquainted">Getting Acquainted</h3> 
  <div class="section"> 
   <h4 id="Checking_Out">Checking Out</h4> 
   <div class="source"> 
    <div class="source"> 
     <pre>git clone git@github.com:eHarmony/aloha.git
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Building">Building</h4> 
   <p>Building takes a minute or so:</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>cd aloha
mvn clean package
</pre> 
    </div> 
   </div> 
   <p>Once everything is built, you should be able to run the examples that follow.</p> 
  </div> 
  <div class="section"> 
   <h4 id="A_Look_at_the_CLI">A Look at the CLI</h4> 
   <div class="source"> 
    <div class="source"> 
     <pre>aloha-cli/bin/aloha-cli
</pre> 
    </div> 
   </div> 
   <div> 
    <pre>
usage: aloha-cli -cp /path/to/some.jar:/path/to/other.jar:... \[args to CLI\]
</pre> 
   </div> 
   <p>So, it’s clear that some jar files need to be specified on the classpath to make the CLI work. Luckily, when aloha is built, the <i>aloha-cli</i> module has a jar that includes all of the necessary dependencies. This can be found automatically with the following shell script magic which looks in the target directory of the <i>aloha-cli</i> module for a jar with dependencies.</p> 
   <p>Let’s try running again with the proper jar on the classpath.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>aloha-cli/bin/aloha-cli                                                        \
  -cp $(find $PWD/aloha-cli -name &quot;*.jar&quot; | grep dependencies)
</pre> 
    </div> 
   </div> 
   <div> 
    <pre>
No arguments supplied. Supply one of: '--dataset', '--modelrunner', '--vw'.
</pre> 
   </div> 
   <p>Now the CLI gets a little further. Let’s choose the <tt>--dataset</tt> option (<i>since we’re making a dataset</i>). </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>aloha-cli/bin/aloha-cli                                                        \
  -cp $(find $PWD/aloha-cli -name &quot;*.jar&quot; | grep dependencies)                 \
  --dataset
</pre> 
    </div> 
   </div> 
   <div> 
    <pre>
Error: Missing option --spec
Error: No output dataset type provided.  Provide at least one of: vw, vw_labeled, vw_cb, libsvm, libsvm_labeled, csv
dataset \[ SOME ALOHA VERSION HERE \]
Usage: dataset \[options\]

  --cachedir &lt;value&gt;
        a cache directory
  --parallel &lt;value&gt;
        a list of Apache VFS URLs additional jars to be included on the classpath
  -s &lt;value&gt; | --spec &lt;value&gt;
        Apache VFS URL to a JSON specification file containing attributes of the dataset being created.
  -p &lt;value&gt; | --proto-input &lt;value&gt;
        canonical class name of the protocol buffer type to use.
  -c &lt;value&gt; | --csv-input &lt;value&gt;
        Apache VFS URL to JSON file specifying the structure of the CSV input.
  -i &lt;value&gt; | --in &lt;value&gt;
        Apache VFS URL to the input file.  If not supplied, STDIN will be used.
  --vw &lt;value&gt;
        produce an unlabeled VW dataset and place the output in the specified location.
  --vw_labeled &lt;value&gt;
        produce a labeled VW dataset and place the output in the specified location.
  --vw_cb &lt;value&gt;
        produce a contextual bandit VW dataset and place the output in the specified location.
  --libsvm &lt;value&gt;
        produce an unlabeled LIBSVM dataset and place the output in the specified location.
  --libsvm_labeled &lt;value&gt;
        produce a labeled LIBSVM dataset and place the output in the specified location.
  --csv &lt;value&gt;
        produce a CSV dataset and place the output in the specified location.
</pre> 
   </div> 
   <p>So, now we’re getting somewhere. Now that we have the lay of the land, let’s create some small datasets for real.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="CSV_Input_Transformed_CSV_output">CSV Input, Transformed CSV output</h3> 
 </div> 
</div>
			</div>
		</div>
	</div>
	<div class="row columns columns2">
		<div class="span6">
			<h4 id="Command_and_Results">Command and Results</h4>
<p><span class="label">Input</span></p>
<div class="source"> 
 <div class="source"> 
  <pre># Creating an Aloha cache directory provides a speed up 
# when running multiple times.  
#
# The cache directory must exist if it's specified.
# 
mkdir -p /tmp/aloha-cache 2&gt;/dev/null
</pre> 
 </div> 
</div>
<div class="source"> 
 <div class="source"> 
  <pre># Read 2 rows of data from STDIN.
(
cat &lt;&lt;EOM
MALE,175,
FEMALE,,books|films|chinese food
EOM
) |\
aloha-cli/bin/aloha-cli                               \
  -cp $(find $PWD/aloha-cli -name &quot;*.jar&quot; | grep dep) \
  --dataset                                           \
  --cachedir /tmp/aloha-cache                         \
  -c $(find $PWD/aloha-core/src -name 'csv_types1.js')\
  -s $(find $PWD/aloha-core/src -name 'csv_spec2.js') \
  --csv -
</pre> 
 </div> 
</div>
<p><span class="label label-success">Output</span></p>
<div> 
 <pre>
MALE,170,0
FEMALE,NULL,3
</pre> 
</div>
<div class="section">      
</div>
		</div>
		<div class="span6">
			<h4 id="Files">Files</h4>
<p><span class="label label-info text-right">csv_types1.js</span></p>
<div class="source"> 
 <div class="source"> 
  <pre>{
  &quot;fs&quot;: &quot;,&quot;,
  &quot;ifs&quot;: &quot;|&quot;,
  &quot;missingData&quot;: &quot;NULL&quot;,
  &quot;errorOnOptMissingField&quot;: false,
  &quot;errorOnOptMissingEnum&quot;: false,
  &quot;columns&quot;: [
    { &quot;name&quot;: &quot;gender&quot;, &quot;type&quot;: &quot;enum&quot;,
      &quot;className&quot;: &quot;a.b.Gender&quot;, 
      &quot;values&quot;: [ &quot;MALE&quot;, &quot;FEMALE&quot; ] },
    { &quot;name&quot;: &quot;weight&quot;, &quot;type&quot;: &quot;int&quot;, &quot;optional&quot;: true },
    { &quot;name&quot;: &quot;likes&quot;, &quot;type&quot;: &quot;string&quot;, &quot;vectorized&quot;: true }
  ]
}
</pre> 
 </div> 
</div>
<p><span class="label label-info text-right">csv_spec2.js</span></p>
<div class="source"> 
 <div class="source"> 
  <pre>{
  &quot;separator&quot;: &quot;,&quot;,
  &quot;nullValue&quot;: &quot;NULL&quot;,
  &quot;encoding&quot;: &quot;regular&quot;,
  &quot;imports&quot;:[],
  &quot;features&quot;: [
    {&quot;name&quot;: &quot;gender&quot;, &quot;spec&quot;:&quot;${gender}&quot; },
    {&quot;name&quot;: &quot;weight&quot;, &quot;spec&quot;:&quot;${weight} / 10 * 10&quot; },
    {&quot;name&quot;: &quot;num_likes&quot;, &quot;spec&quot;:&quot;${likes}.size&quot; }
  ]
}
</pre> 
 </div> 
</div>
		</div>
	</div>
	<div class="row">
	</div>
	<div class="row">
		<div class="span12">
			<div class="body-content">
				<p>Let’s look at the file structure and examine what happened.</p>
<p><span class="label">Input</span></p>
<div class="source"> 
 <div class="source"> 
  <pre># ================================================
# Create temporary input and output files
# ================================================
INFILE=$(mktemp -t example_input)
OUTFILE=$(mktemp -t example_output)

# ================================================
# File in file w/ base64-encoded UserProto data.
# ================================================
(
cat &lt;&lt;EOM
CAESBEFsYW4YASUAALhBKg0IARABGQAAAAAAAPA/Kg0IAhACGQAAAAAAAABA
CAESBEthdGUYAioNCAMQAxkAAAAAAAAIQA==
EOM
) &gt;&gt; $INFILE

# ================================================
#  Make a VW dataset.
#  Run CLI w/ an input file, output to a file.
# ================================================
aloha-cli/bin/aloha-cli                                \
  -cp $(find $PWD/aloha-cli -name &quot;*.jar&quot; | grep dep):\
$(find $PWD/aloha-core -name &quot;*.jar&quot; | grep test)      \
  --dataset                                            \
  -i $INFILE                                           \
  -s $(find $PWD/aloha-core/src -name 'proto_spec1.js')\
  -p com.eharmony.aloha.test.proto.Testing.UserProto   \
  --cachedir /tmp/aloha-cache                          \
  --vw $OUTFILE

# ================================================
#  Clean up temp files and print the output.
# ================================================
rm -f $INFILE
cat $OUTFILE
rm -f $OUTFILE
</pre> 
 </div> 
</div>
<p><span class="label label-success">Output</span></p>
<div> 
 <pre>
| name=Alan gender=MALE bmi:23 num_photos:2
| name=Kate gender=FEMALE bmi=UNK num_photos
</pre> 
</div>
<div class="source"> 
 <div class="source"> 
  <pre>mkdir -p /tmp/aloha-cache 2&gt;/dev/null
</pre> 
 </div> 
</div>
<div class="source"> 
 <div class="source"> 
  <pre># Go to the root aloha directory. 
cd aloha

(
 echo &quot;MALE,175,&quot;
 echo &quot;FEMALE,,books|films|chinese food&quot;
) |\
aloha-cli/bin/aloha-cli                                               \
  -cp $(find $PWD/aloha-cli -name &quot;*.jar&quot; | grep dependencies)        \
  --dataset                                                           \
  -s $(find $PWD/aloha-core/src/test/resources -name 'csv_spec2.js')  \
  -c $(find $PWD/aloha-core/src/test/resources -name 'csv_types1.js') \
  --cachedir /tmp/aloha-cache                                         \
  --csv -
</pre> 
 </div> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="../" title="Home">Home</a>
						</li>
						<li >
							<a href="http://github.com/eharmony/aloha/" title="Code" class="externalLink">Code</a>
						</li>
						<li >
							<a href="../release-notes.html" title="Release notes">Release notes</a>
						</li>
						<li class="nav-header">Maven Documentation</li>
						<li >
							<a href="../project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">API Docs</li>
						<li >
							<a href="../aloha-core/scaladocs/index.html" title="aloha-core">aloha-core</a>
						</li>
						<li >
							<a href="../aloha-vw-jni/scaladocs/index.html" title="aloha-vw-jni">aloha-vw-jni</a>
						</li>
						<li >
							<a href="../aloha-cli/scaladocs/index.html" title="aloha-cli">aloha-cli</a>
						</li>
						<li class="nav-header">Contribute</li>
						<li >
							<a href="http://github.com/eharmony/aloha/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="http://github.com/eharmony/aloha/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li >
							<a href="../contribute.html" title="Contribute">Contribute</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Dataset Examples</li>
						<li >
							<a href="dataset/csv.html" title="CSV">CSV</a>
						</li>
						<li >
							<a href="dataset/vw.html" title="VW Unlabeled">VW Unlabeled</a>
						</li>
						<li >
							<a href="dataset/labeled_vw.html" title="VW Labeled">VW Labeled</a>
						</li>
						<li >
							<a href="dataset/cb_vw.html" title="VW Bandit">VW Bandit</a>
						</li>
						<li >
							<a href="dataset/libsvm.html" title="LIBSVM Unlabeled">LIBSVM Unlabeled</a>
						</li>
						<li >
							<a href="dataset/labeled_libsvm.html" title="LIBSVM Labeled">LIBSVM Labeled</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">Aloha</span> is a scala-based feature generation and modeling framework.</blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2013-2015 <a href="http://eharmony.com">eHarmony</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 2.0.1-SNAPSHOT. </span><span class="publishDate">Last Published: 2015-08-31. </span></p>
					</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>
	
<script src="../js/highlight/highlight.pack.js"></script>
	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
