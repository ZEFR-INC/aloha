
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-11-01
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Model Formats | aloha</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href=".//css/docs.css" rel="stylesheet" />
		<link href=".//css/reflow-skin.css" rel="stylesheet" />


		<link href=".//css/lightbox.css" rel="stylesheet" />

		<link href=".//css/site.css" rel="stylesheet" />
		<link href=".//css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="stylesheet" href=".//css/highlight/github.css"/>
	</head>

	<body class="page-model_formats project-aloha" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><span class="color-highlight">Aloha</span></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="http://github.com/eharmony/aloha/" title="Code" class="externalLink">Code</a></li>
							<li class="active"><a href="" title="Model Formats">Model Formats</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Dataset Examples <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="eg/dataset/csv.html" title="CSV">CSV</a></li>
									<li ><a href="eg/dataset/vw.html" title="VW Unlabeled">VW Unlabeled</a></li>
									<li ><a href="eg/dataset/labeled_vw.html" title="VW Labeled">VW Labeled</a></li>
									<li ><a href="eg/dataset/cb_vw.html" title="VW Bandit">VW Bandit</a></li>
									<li ><a href="eg/dataset/libsvm.html" title="LIBSVM Unlabeled">LIBSVM Unlabeled</a></li>
									<li ><a href="eg/dataset/labeled_libsvm.html" title="LIBSVM Labeled">LIBSVM Labeled</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar" data-spy="affix" data-offset-top="40">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#toc-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="nav-collapse collapse" id="toc-nav-collapse">
						<ul id="toc" class="nav">
						<li class="toplevel"><a href="#model_formats" title="Model Formats">Model Formats</a></li>
						<li class="dropdown">
							<a href="#Prerequisites" title="Prerequisites" class="dropdown-toggle" role="button" data-toggle="dropdown" data-target="#">Prerequisites <b class="caret"></b></a>
							<ul class="dropdown-menu" role="menu">
								<!-- Repeat the item, otherwise it is not clickable as the dropdown root -->
								<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
								<li class="divider"></li>
								<li><a href="#Common_Required_JSON_Fields" title="Common Required JSON Fields">Common Required JSON Fields</a></li>
								<li><a href="#Models_Should_be_Immutable" title="Models Should be Immutable">Models Should be Immutable</a></li>

							</ul>
						</li>
						<li class="toplevel"><a href="#Model_Types" title="Model Types">Model Types</a></li>
		<li class="divider-vertical"></li>
		<li class="dropdown">
			<a href="#" title="More&hellip;" class="dropdown-toggle" role="button" data-toggle="dropdown" data-target="#">&hellip; <b class="caret"></b></a>
			<ul class="dropdown-menu" role="menu">
								<li class="dropdown-submenu">
									<a href="#Categorical_distribution_model" title="Categorical distribution model">Categorical distribution model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aCD_JSON_Fields" title="(CD) JSON Fields">(CD) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aCD_JSON_Field_Descriptions" title="(CD) JSON Field Descriptions">(CD) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aCD_modelType" title="(CD) modelType">(CD) modelType</a></li>
								<li><a href="#aCD_features" title="(CD) features">(CD) features</a></li>
								<li><a href="#aCD_probabilities" title="(CD) probabilities">(CD) probabilities</a></li>
								<li><a href="#aCD_labels" title="(CD) labels">(CD) labels</a></li>
								<li><a href="#aCD_missingOk" title="(CD) missingOk">(CD) missingOk</a></li>

									</ul>
								</li>
								<li><a href="#aCD_JSON_Examples" title="(CD) JSON Examples">(CD) JSON Examples</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Constant_model" title="Constant model">Constant model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aC_JSON_Fields" title="(C) JSON Fields">(C) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aC_JSON_Field_Descriptions" title="(C) JSON Field Descriptions">(C) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aC_modelType" title="(C) modelType">(C) modelType</a></li>
								<li><a href="#aC_value" title="(C) value">(C) value</a></li>

									</ul>
								</li>
								<li><a href="#aC_JSON_Examples" title="(C) JSON Examples">(C) JSON Examples</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Decision_tree_model" title="Decision tree model">Decision tree model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDT_JSON_Fields" title="(DT) JSON Fields">(DT) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aDT_JSON_Field_Descriptions" title="(DT) JSON Field Descriptions">(DT) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDT_modelType" title="(DT) modelType">(DT) modelType</a></li>
								<li><a href="#aDT_returnBest" title="(DT) returnBest">(DT) returnBest</a></li>
								<li><a href="#aDT_missingDataOk" title="(DT) missingDataOk">(DT) missingDataOk</a></li>
								<li class="dropdown-submenu">
									<a href="#aDT_nodes" title="(DT) nodes">(DT) nodes</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aNode_id" title="(Node) id">(Node) id</a></li>
								<li><a href="#aNode_value" title="(Node) value">(Node) value</a></li>
								<li><a href="#aNode_selector" title="(Node) selector">(Node) selector</a></li>

									</ul>
								</li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Node_Selectors" title="Node Selectors">Node Selectors</a>
									<ul class="dropdown-menu" role="menu">
								<li class="dropdown-submenu">
									<a href="#Linear_Node_Selector" title="Linear Node Selector">Linear Node Selector</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#alinear_ns_selectorType" title="(linear ns) selectorType">(linear ns) selectorType</a></li>
								<li><a href="#alinear_ns_children" title="(linear ns) children">(linear ns) children</a></li>
								<li><a href="#alinear_ns_predicates" title="(linear ns) predicates">(linear ns) predicates</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Random_Node_Selector" title="Random Node Selector">Random Node Selector</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#arandom_ns_selectorType" title="(random ns) selectorType">(random ns) selectorType</a></li>
								<li><a href="#arandom_ns_children" title="(random ns) children">(random ns) children</a></li>
								<li><a href="#arandom_ns_probabilities" title="(random ns) probabilities">(random ns) probabilities</a></li>
								<li><a href="#arandom_ns_features" title="(random ns) features">(random ns) features</a></li>

									</ul>
								</li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#aDT_JSON_Examples" title="(DT) JSON Examples">(DT) JSON Examples</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDT_One_Node_Tree_Example" title="(DT) One Node Tree Example">(DT) One Node Tree Example</a></li>
								<li><a href="#aDT_Three_Node_Tree_Example" title="(DT) Three Node Tree Example">(DT) Three Node Tree Example</a></li>
								<li><a href="#aDT_Random_Branching_Example" title="(DT) Random Branching Example">(DT) Random Branching Example</a></li>
								<li><a href="#aDT_Short-Circuit_Random_Branching_Example" title="(DT) Short-Circuit Random Branching Example">(DT) Short-Circuit Random Branching Example</a></li>

									</ul>
								</li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Double-to-Long_model" title="Double-to-Long model">Double-to-Long model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDtL_JSON_Fields" title="(DtL) JSON Fields">(DtL) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aDtL_JSON_Field_Descriptions" title="(DtL) JSON Field Descriptions">(DtL) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDtL_modelType" title="(DtL) modelType">(DtL) modelType</a></li>
								<li><a href="#aDtL_submodel" title="(DtL) submodel">(DtL) submodel</a></li>
								<li><a href="#aDtL_scale" title="(DtL) scale">(DtL) scale</a></li>
								<li><a href="#aDtL_translation" title="(DtL) translation">(DtL) translation</a></li>
								<li><a href="#aDtL_clampLower" title="(DtL) clampLower">(DtL) clampLower</a></li>
								<li><a href="#aDtL_clampUpper" title="(DtL) clampUpper">(DtL) clampUpper</a></li>
								<li><a href="#aDtL_round" title="(DtL) round">(DtL) round</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#aDtL_JSON_Examples" title="(DtL) JSON Examples">(DtL) JSON Examples</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aDtL_Minimal_Example" title="(DtL) Minimal Example">(DtL) Minimal Example</a></li>
								<li><a href="#aDtL_Full_Example" title="(DtL) Full Example">(DtL) Full Example</a></li>

									</ul>
								</li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Error_model" title="Error model">Error model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aE_JSON_Fields" title="(E) JSON Fields">(E) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aE_JSON_Field_Descriptions" title="(E) JSON Field Descriptions">(E) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aE_modelType" title="(E) modelType">(E) modelType</a></li>
								<li><a href="#aE_errors" title="(E) errors">(E) errors</a></li>

									</ul>
								</li>
								<li><a href="#aE_JSON_Examples" title="(E) JSON Examples">(E) JSON Examples</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Error-swallowing_model" title="Error-swallowing model">Error-swallowing model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aES_JSON_Fields" title="(ES) JSON Fields">(ES) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aES_JSON_Field_Descriptions" title="(ES) JSON Field Descriptions">(ES) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aES_modelType" title="(ES) modelType">(ES) modelType</a></li>
								<li><a href="#aES_submodel" title="(ES) submodel">(ES) submodel</a></li>
								<li><a href="#aES_recordErrorStackTraces" title="(ES) recordErrorStackTraces">(ES) recordErrorStackTraces</a></li>

									</ul>
								</li>
								<li><a href="#aES_JSON_Examples" title="(ES) JSON Examples">(ES) JSON Examples</a></li>

									</ul>
								</li>
								<li><a href="#Model_decision_tree_model" title="Model decision tree model">Model decision tree model</a></li>
								<li class="dropdown-submenu">
									<a href="#Regression_model" title="Regression model">Regression model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_JSON_Fields" title="(R) JSON Fields">(R) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aR_JSON_Field_Descriptions" title="(R) JSON Field Descriptions">(R) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_modelType" title="(R) modelType">(R) modelType</a></li>
								<li class="dropdown-submenu">
									<a href="#aR_features" title="(R) features">(R) features</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_feature_spec" title="(R) feature spec">(R) feature spec</a></li>
								<li><a href="#aR_feature_defVal" title="(R) feature defVal">(R) feature defVal</a></li>
								<li><a href="#aR_spec_as_a_String" title="(R) spec (as a String)">(R) spec (as a String)</a></li>

									</ul>
								</li>
								<li><a href="#aR_weights" title="(R) weights">(R) weights</a></li>
								<li class="dropdown-submenu">
									<a href="#aR_higherOrderFeatures" title="(R) higherOrderFeatures">(R) higherOrderFeatures</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_higherOrderFeatures_wt" title="(R) higherOrderFeatures wt">(R) higherOrderFeatures wt</a></li>
								<li><a href="#aR_higherOrderFeatures_features" title="(R) higherOrderFeatures features">(R) higherOrderFeatures features</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#aR_spline" title="(R) spline">(R) spline</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_spline_min" title="(R) spline min">(R) spline min</a></li>
								<li><a href="#aR_spline_max" title="(R) spline max">(R) spline max</a></li>
								<li><a href="#aR_spline_knots" title="(R) spline knots">(R) spline knots</a></li>

									</ul>
								</li>
								<li><a href="#aR_numMissingThreshold" title="(R) numMissingThreshold">(R) numMissingThreshold</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#aR_JSON_Examples" title="(R) JSON Examples">(R) JSON Examples</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aR_Basic_Example" title="(R) Basic Example">(R) Basic Example</a></li>
								<li><a href="#aR_higherOrderFeatures_Example" title="(R) higherOrderFeatures Example">(R) higherOrderFeatures Example</a></li>

									</ul>
								</li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Segmentation_model" title="Segmentation model">Segmentation model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aS_JSON_Fields" title="(S) JSON Fields">(S) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aS_JSON_Field_Descriptions" title="(S) JSON Field Descriptions">(S) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aS_modelType" title="(S) modelType">(S) modelType</a></li>
								<li><a href="#aS_subModel" title="(S) subModel">(S) subModel</a></li>
								<li><a href="#aS_subModelOutputType" title="(S) subModelOutputType">(S) subModelOutputType</a></li>
								<li><a href="#aS_thresholds" title="(S) thresholds">(S) thresholds</a></li>
								<li><a href="#aS_labels" title="(S) labels">(S) labels</a></li>

									</ul>
								</li>
								<li><a href="#aS_JSON_Examples" title="(S) JSON Examples">(S) JSON Examples</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#Vowpal_Wabbit_model" title="Vowpal Wabbit model">Vowpal Wabbit model</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aVW_JSON_Fields" title="(VW) JSON Fields">(VW) JSON Fields</a></li>
								<li class="dropdown-submenu">
									<a href="#aVW_JSON_Field_Descriptions" title="(VW) JSON Field Descriptions">(VW) JSON Field Descriptions</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aVW_modelType" title="(VW) modelType">(VW) modelType</a></li>
								<li><a href="#aVW_features" title="(VW) features">(VW) features</a></li>
								<li class="dropdown-submenu">
									<a href="#aVW_vw" title="(VW) vw">(VW) vw</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aVW_vw_creationTime" title="(VW) vw creationTime">(VW) vw creationTime</a></li>
								<li><a href="#aVW_vw_model" title="(VW) vw model">(VW) vw model</a></li>
								<li><a href="#aVW_vw_modelUrl" title="(VW) vw modelUrl">(VW) vw modelUrl</a></li>
								<li><a href="#aVW_vw_via" title="(VW) vw via">(VW) vw via</a></li>
								<li><a href="#aVW_vw_params" title="(VW) vw params">(VW) vw params</a></li>

									</ul>
								</li>
								<li><a href="#aVW_namespaces" title="(VW) namespaces">(VW) namespaces</a></li>
								<li><a href="#aVW_numMissingThreshold" title="(VW) numMissingThreshold">(VW) numMissingThreshold</a></li>
								<li><a href="#aVW_notes" title="(VW) notes">(VW) notes</a></li>
								<li><a href="#aVW_spline" title="(VW) spline">(VW) spline</a></li>

									</ul>
								</li>
								<li class="dropdown-submenu">
									<a href="#aVW_JSON_Examples" title="(VW) JSON Examples">(VW) JSON Examples</a>
									<ul class="dropdown-menu" role="menu">
								<li><a href="#aVW_Base64_Encoded_Model_JSON_Example" title="(VW) Base64 Encoded Model JSON Example">(VW) Base64 Encoded Model JSON Example</a></li>
								<li><a href="#aVW_Model_URL_JSON_Example" title="(VW) Model URL JSON Example">(VW) Model URL JSON Example</a></li>
								<li><a href="#aVW_Model_URL_via_vfs1_JSON_Example" title="(VW) Model URL via ‘vfs1’ JSON Example">(VW) Model URL via ‘vfs1’ JSON Example</a></li>

									</ul>
								</li>

									</ul>
								</li>

			</ul>
		</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1 id="model_formats">Model Formats</h1>
</div> 
<div class="section"> 
 <h2 id="Prerequisites">Prerequisites</h2> 
 <div class="section"> 
  <h3 id="Common_Required_JSON_Fields">Common Required JSON Fields</h3> 
  <ul> 
   <li><tt>modelType</tt> is a string defining the type of model the JSON in the same object block represents. These values are predefined within the model definitions and won’t change without a major version change since Aloha uses <a class="externalLink" href="http://semver.org">semantic versioning</a>. See a model description below to determine the associated <tt>modelType</tt> field.</li> 
   <li><tt>modelId</tt> is a JSON object that acts as an identifier for models. It is represented by an object with two fields <tt>id</tt>, a 64-bit integer and <tt>name</tt>, a string.</li> 
  </ul> 
 </div> 
 <div class="section"> 
  <h3 id="Models_Should_be_Immutable">Models Should be Immutable</h3> 
  <blockquote> 
   <p><b>NOTE</b>: While Aloha doesn’t place any special importance of the uniqueness of these model IDs and doesn’t assign any special semantic meaning to these fields, <i>Aloha users</i> <b><i>SHOULD</i></b> <i>place special importance on the uniqueness of the numeric <tt>id</tt>.</i> </p> 
  </blockquote> 
  <p>This is just a suggestion but it will pay huge dividends in terms of cleaner data collection:</p> 
  <blockquote> 
   <p>Models should for practical purposes be immutable. This means that whenever a model is edited in such a way that the model functionally changes, the model’s <tt>modelId</tt>’s <tt>id</tt> field should be changed <b>And all ancestor models’ <tt>modelId</tt>’s <tt>id</tt> field should change.</b></p> 
  </blockquote> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Model_Types">Model Types</h2> 
 <ul> 
  <li><a href="#Categorical_distribution_model">Categorical distribution model</a>: returns pseudo-random values based on a designated <a class="externalLink" href="https://en.wikipedia.org/wiki/Categorical_distribution">Categorical distribution</a></li> 
  <li><a href="#Constant_model">Constant model</a>: returns a constant value</li> 
  <li><a href="#Decision_tree_model">Decision tree model</a>: a standard <a class="externalLink" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a></li> 
  <li><a href="#Double-to-Long_model">Double-to-Long model</a>: provides an <a class="externalLink" href="https://en.wikipedia.org/wiki/Affine_transformation">affine transformation</a> from Double values to Long values</li> 
  <li><a href="#Error_model">Error model</a>: a model for returning errors rather than returning a score or throwing an exception.</li> 
  <li><a href="#Error-swallowing_model">Error-swallowing model</a>: swallows all errors (exceptions) and returns a <i>no-score</i> if an error is encountered.</li> 
  <li><a href="#Model_decision_tree_model">Model decision tree model</a>: a <a class="externalLink" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a> whose nodes are models that when reached are applied to the input data.</li> 
  <li><a href="#Regression_model">Regression model</a>: a <a class="externalLink" href="https://en.wikipedia.org/wiki/Sparse_matrix">sparse</a> <a class="externalLink" href="https://en.wikipedia.org/wiki/Polynomial_regression">polynomial regression</a> model</li> 
  <li><a href="#Segmentation_model">Segmentation model</a>: a vanilla <a class="externalLink" href="https://en.wikipedia.org/wiki/Market_segmentation">segmentation</a> model based on linear search in an <a class="externalLink" href="https://en.wikipedia.org/wiki/Interval_(mathematics)">interval</a> space</li> 
  <li><a href="#Vowpal_Wabbit_model">Vowpal Wabbit model</a>: a model exposing <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/wiki">VW</a> through its <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/tree/master/java">JNI</a> wrapper</li> 
 </ul> 
</div> 
<div class="section"> 
 <h2 id="Categorical_distribution_model">Categorical distribution model</h2> 
 <p>A Categorical distribution model returns pseudo-random values based on a designated <a class="externalLink" href="https://en.wikipedia.org/wiki/Categorical_distribution">Categorical distribution</a>. It can be used for collecting random data on which future models can be trained. Its sampling is constant time, regardless of the number of values in the distribution.</p> 
 <div class="section"> 
  <h3 id="aCD_JSON_Fields">(CD) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aCD_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aCD_features">features</a></td> 
     <td>Array</td> 
     <td>String</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aCD_probabilities">probabilities</a></td> 
     <td>Array</td> 
     <td>Number</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aCD_labels">labels</a></td> 
     <td>Array</td> 
     <td><b>OUTPUT</b></td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aCD_missing">missingOk</a></td> 
     <td>Boolean</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>false</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aCD_JSON_Field_Descriptions">(CD) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aCD_modelType">(CD) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>CategoricalDistribution</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aCD_features">(CD) features</h4> 
   <p><tt>features</tt> is an array of strings, where each string contains an Aloha feature specification. Each of these strings should just contain a variable definition. These features are used to create a hash on which the pseudo-randomness is based. It can be thought of as the <a class="externalLink" href="https://en.wikipedia.org/wiki/Statistical_unit">statistical unit</a> for the experiment being run.</p> 
   <p>An example value might be: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>[ &quot;${profile.user_id}&quot;, &quot;1&quot; ] 
</pre> 
    </div> 
   </div> 
   <p>where the second element, <i>1</i>, acts as a <a class="externalLink" href="https://en.wikipedia.org/wiki/Salt_(cryptography)">hash salt</a>. When using unique hash salts for every hash, one can avoid interaction in multiple hashes. For more information on salting including an example of issues that can arise, see <a class="externalLink" href="https://deaktator.github.io/presentations/prob-testing/#/10">Salts and Seeds</a> in <a class="externalLink" href="https://deaktator.github.io/presentations/prob-testing">Testing in an Unsure World</a> by <a class="externalLink" href="https://deaktator.github.io">Ryan Deak</a>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aCD_probabilities">(CD) probabilities</h4> 
   <p><tt>probabilities</tt> is an array of non-negative numbers. These values, once <a class="externalLink" href="https://en.wikipedia.org/wiki/Normalization_(statistics)">normalized</a>, will provide the probability of selecting one of the associated <i>labels</i> at the same index in the <a class="externalLink" href="https://en.wikipedia.org/wiki/Parallel_array">parallel</a> <tt>labels</tt> array. While these values needn’t be normalized in the JSON, it may help to supply normalized values if exact normalized probabilities can be provided. If exact values cannot be provided, it’s OK to provide approximations, so long as the ratios are the same as the final normalized <a class="externalLink" href="https://en.wikipedia.org/wiki/Probability_vector">probability vector</a>. For instance, the following are both perfectly fine, but I would opt for the second: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>[ 1, 1, 1 ]
</pre> 
    </div> 
   </div> 
   <div class="source"> 
    <div class="source"> 
     <pre>[ 0.33, 0.33, 0.33 ]
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aCD_labels">(CD) labels</h4> 
   <p><tt>labels</tt> are the actual values returned when a value is sampled from the distribution. The <i>type of value</i> in <tt>labels</tt> is dependent on the model’s output type. For instance, if the model output type is a string, then the JSON value type in <tt>labels</tt> will be strings. If the output type is a 64-bit float, the JSON type in the <tt>labels</tt> array will be <tt>Number</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aCD_missingOk">(CD) missingOk</h4> 
   <p><tt>missingOk</tt> determines whether the model should return a value when at least one of the values in <tt>features</tt> could not be determined. If <tt>false</tt>, no score will be returned. If <tt>true</tt>, then a constant will be used in place of the feature value and will be incorporated into the hash.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aCD_JSON_Examples">(CD) JSON Examples</h3> 
  <p>This example samples values <i>{ 1, 2, 3, 4 }</i> based on a user ID and the number of days since Jan 1, 1970. This means that for any day, regardless of how many times the model is called, the same user will always get the same value. This value can however change from day to day.</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;CategoricalDistribution&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 3, &quot;name&quot;: &quot;model with E[X] = 3&quot; },
  &quot;features&quot;: [ &quot;${profile.id}&quot;, &quot;${calculated_values.days_since_epoch}&quot;, &quot;1&quot; ],
  &quot;probabilities&quot;: [ 0.1, 0.2, 0.3, 0.4 ] ,
  &quot;labels&quot;: [ 1, 2, 3, 4 ],
  &quot;missingOk&quot;: false
}
</pre> 
   </div> 
  </div> 
  <p>Imagine a situation where <i>Alice</i> and <i>Bob</i> are talking to each other and each of them is equally likely to start a conversation with the other person. But with a one percent probability <i>Manny</i> will intercept the message and will forward his own message to the person from whom the message did not originate. This model can probabilistically model the sender of the message that was received by either <i>Alice</i> or <i>Bob</i>. </p> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;CategoricalDistribution&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;man-in-the-middle-model&quot; },
  &quot;features&quot;: [ &quot;${conversation.id}&quot;, &quot;2&quot; ],
  &quot;probabilities&quot;: [ 0.495, 0.495, 0.01 ] ,
  &quot;labels&quot;: [ &quot;Bob&quot;, &quot;Alice&quot;, &quot;Manny&quot; ],
  &quot;missingOk&quot;: true
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Constant_model">Constant model</h2> 
 <p>A constant model always returns the same value.</p> 
 <div class="section"> 
  <h3 id="aC_JSON_Fields">(C) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aC_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aC_value">value</a></td> 
     <td><b>OUTPUT</b></td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aC_JSON_Field_Descriptions">(C) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aC_modelType">(C) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>Constant</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aC_value">(C) value</h4> 
   <p><tt>value</tt> field’s <i>type</i> is dependent on the model’s output type.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aC_JSON_Examples">(C) JSON Examples</h3> 
  <p>Always return <i>1</i>. Whether <i>1</i> is a 32-bit integer, 64-bit integer, 32-bit or 64-bit float is dependent on the output type of the model. </p> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;Constant&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;model that always returns 1&quot; },
  &quot;value&quot;: 1
}
</pre> 
   </div> 
  </div> 
  <p>Always return <tt>&quot;awesome&quot;</tt>. This model will parse assuming the output type of the model is <tt>String</tt>. </p> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;Constant&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;model that always returns 'awesome'&quot; },
  &quot;value&quot;: &quot;awesome&quot;
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Decision_tree_model">Decision tree model</h2> 
 <p>Decision trees are what one might expect from a <a class="externalLink" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a>: they encode the ability to return different values based on <a class="externalLink" href="https://en.wikipedia.org/wiki/Predicate_(mathematical_logic)">predicates</a> that hold for a given input datum. Aloha encodes trees as a <a class="externalLink" href="https://en.wikipedia.org/wiki/Graph_(mathematics)">graph</a>-like structure so that the code could be extended to <a class="externalLink" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">DAG</a>s in a straightforward way. The first node in the <tt>nodes</tt> array is considered to be the root node.</p> 
 <div class="section"> 
  <h3 id="aDT_JSON_Fields">(DT) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aDT_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aDT_returnBest">returnBest</a></td> 
     <td>Boolean</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aDT_missingDataOk">missingDataOk</a></td> 
     <td>Boolean</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aDT_nodes">nodes</a></td> 
     <td>Array</td> 
     <td><a href="#aDT_nodes">Node<sup>*</sup></a></td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aDT_JSON_Field_Descriptions">(DT) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aDT_modelType">(DT) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>DecisionTree</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_returnBest">(DT) returnBest</h4> 
   <p><tt>returnBest</tt> is a Boolean that when <tt>true</tt> let’s the decision tree return a value associated with an <a class="externalLink" href="https://en.wikipedia.org/wiki/Tree_(data_structure)#Terminologies_used_in_Trees">internal node</a> when no further progress down the tree can be made. </p> 
   <p>When set to false, the model returns an error rather than a score.</p> 
   <p>Usually, in a decision tree, the inability to produce a path from the tree root to a leaf is indicative of a problem. The most common problem being that the branching logic at a given node is not <a class="externalLink" href="https://en.wikipedia.org/wiki/Collectively_exhaustive_events">exhaustive</a>. This will happen when the tree algorithm checks if it can proceed to any of its children and the predicates associated with each child return <tt>false</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_missingDataOk">(DT) missingDataOk</h4> 
   <p><tt>missingDataOk</tt> is a Boolean telling whether missing data is OK. In the event that <tt>missingDataOk</tt> is set to <tt>false</tt>, when a variable in a node selector is missing, the node selector should stop and report to the decision tree that it can’t make a decision on which child to traverse. The subsequent behavior is dictated by <a href="#aDT_returnBest">returnBest</a>.</p> 
   <p>If <tt>missingDataOk</tt> is <tt>true</tt>, then when a node selector encounters missing data, it can still recover. For instance, when a <tt>linear</tt> node selector encounters missing data in one of the predicates, it will assume the predicate evaluates to <tt>false</tt> and will continue on to the next predicate. This behavior may vary across node selectors of different types.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_nodes">(DT) nodes</h4> 
   <p><tt>nodes</tt> contains the list of nodes in the decision tree. As was mentioned above, trees are encoded in a tabular way to provide future extensibility to decision <a class="externalLink" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">DAG</a>s. The first node in the <tt>nodes</tt> array is considered to be the root node. The structure of a node is as follows:</p> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#aNode_id">id</a></td> 
      <td>Number</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aNode_value">value</a></td> 
      <td><b>OUTPUT</b></td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#Node_Selectors">selector</a></td> 
      <td><a href="#Node_Selectors">Node Selector<sup>*</sup></a></td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>N / A</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="aNode_id">(Node) id</h5> 
    <p><tt>id</tt> is the node id and is used by <a href="#Node_Selectors">node selectors</a> to determine which child to traverse. Note that this is independent of the model’s <tt>id</tt>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aNode_value">(Node) value</h5> 
    <p><tt>value</tt> in nodes are the values potentially return by the decision tree when a given node is selected. </p> 
   </div> 
   <div class="section"> 
    <h5 id="aNode_selector">(Node) selector</h5> 
    <p><tt>selector</tt> is the data type responsible for determining which child to traverse. It is required for internal nodes but should not be included for leaf nodes. For the different type of node selectors, see the <a href="#Node_Selectors">Node Selectors</a> section.</p> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Node_Selectors">Node Selectors</h3> 
  <p><i>Node selectors</i> are responsible for determining which child in the tree to traverse. Currently, the following types of node selectors exist: </p> 
  <ul> 
   <li><a href="#Linear_Node_Selector">Linear node selector</a></li> 
   <li><a href="#Random_Node_Selector">Random node selector</a></li> 
  </ul> 
  <div class="section"> 
   <h4 id="Linear_Node_Selector">Linear Node Selector</h4> 
   <p>Linear node selectors work like an <a class="externalLink" href="https://en.wikipedia.org/wiki/Conditional_(computer_programming)#If.E2.80.93then.28.E2.80.93else.29">IF-THEN-ELSE</a> statement. Children are ordered and a predicate is associated with each child. A <a class="externalLink" href="https://en.wikipedia.org/wiki/Linear_search">linear search</a> is performed to find the first predicate that yields a value of <i>true</i>. If no predicate yields true, then the decision tree split is said to be not <a class="externalLink" href="https://en.wikipedia.org/wiki/Collectively_exhaustive_events">exhaustive</a>. In this case, the <a href="#returnBest">returnBest</a> field of the decision tree determines the subsequent behavior. This selector algorithm acts in <i>O</i>(<i>N</i>) time where <i>N</i> is node’s the number of children.</p> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#alinear_ns_selectorType">selectorType</a></td> 
      <td>String</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#alinear_ns_children">children</a></td> 
      <td>Array</td> 
      <td>Number</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#alinear_ns_predicates">predicates</a></td> 
      <td>Array</td> 
      <td>String</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="alinear_ns_selectorType">(linear ns) selectorType</h5> 
    <p><tt>selectorType</tt> must be <tt>linear</tt>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="alinear_ns_children">(linear ns) children</h5> 
    <p><tt>children</tt> is a list of <tt>node</tt> <tt>id</tt> values. This array is <a class="externalLink" href="https://en.wikipedia.org/wiki/Parallel_array">parallel</a> to the <tt>predicates</tt> array. If index <i>i</i> in <tt>predicates</tt> is the first predicate yielding <i>true</i>, then the value at index <i>i</i> in <tt>children</tt> will contain the <i>id</i> of the node that will be visited.</p> 
   </div> 
   <div class="section"> 
    <h5 id="alinear_ns_predicates">(linear ns) predicates</h5> 
    <p>The <tt>predicates</tt> array contains strings where each string is an Aloha feature specification representing a Boolean function. This array is <a class="externalLink" href="https://en.wikipedia.org/wiki/Parallel_array">parallel</a> to the <tt>children</tt> array. If index <i>i</i> in <tt>predicates</tt> is the first predicate yielding <i>true</i>, then the value at index <i>i</i> in <tt>children</tt> will contain the <i>id</i> of the node that will be visited.</p> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Random_Node_Selector">Random Node Selector</h4> 
   <p>A random node selector provides a way of pseudo-randomly splitting traffic between one or more outcomes. This selector algorithm acts in <i>O</i>(1) time regardless of the number of children.</p> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#arandom_ns_selectorType">selectorType</a></td> 
      <td>String</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#arandom_ns_children">children</a></td> 
      <td>Array</td> 
      <td>Number</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#arandom_ns_probabilities">probabilities</a></td> 
      <td>Array</td> 
      <td>Number</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#arandom_ns_features">features</a></td> 
      <td>Array</td> 
      <td>String</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="arandom_ns_selectorType">(random ns) selectorType</h5> 
    <p><tt>selectorType</tt> must be <tt>random</tt>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="arandom_ns_children">(random ns) children</h5> 
    <p><tt>children</tt> is a list of <tt>node</tt> <tt>id</tt> values. This array is <a class="externalLink" href="https://en.wikipedia.org/wiki/Parallel_array">parallel</a> to the <tt>probabilities</tt> array. Samples drawn from the <a class="externalLink" href="https://en.wikipedia.org/wiki/Categorical_distribution">Categorical distribution</a> backed by <tt>probabilities</tt> yield an index into the <tt>children</tt> array. The <tt>id</tt> at the chosen index in the <tt>children</tt> array is used to select the child to traverse. </p> 
    <p><b>Note</b>: There is a special case when the length of <tt>children</tt> can be one less than the length of the <tt>probabilities</tt> array. In such a case, if <tt>returnBest</tt> is set to <i>true</i> then when the sampling from the categorical distribution selects last index in <tt>probabilities</tt>, the <i>current node</i> (and not a child node) is selected. See JSON examples for how this is useful.</p> 
   </div> 
   <div class="section"> 
    <h5 id="arandom_ns_probabilities">(random ns) probabilities</h5> 
    <p><tt>probabilities</tt> is a (possibly unnormalized) <a class="externalLink" href="https://en.wikipedia.org/wiki/Probability_vector">probability vector</a>. This array is <a class="externalLink" href="https://en.wikipedia.org/wiki/Parallel_array">parallel</a> to the <tt>children</tt> array. Samples drawn from the <a class="externalLink" href="https://en.wikipedia.org/wiki/Categorical_distribution">Categorical distribution</a> backed by <tt>probabilities</tt> yield an index into the <tt>children</tt> array. The <tt>id</tt> at the chosen index in the <tt>children</tt> array is used to select the child to traverse. </p> 
    <p>While <tt>probabilities</tt> will be normalized and it’s not strictly required to provide a normalized probabilities in <tt>probabilities</tt>, it is most likely more readable to provide normalized probabilities as long as the ratios can be encoded exactly. For instance </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>[ 0.33, 0.33, 0.33 ]
</pre> 
     </div> 
    </div> 
    <p>may be preferable to </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>[ 1, 1, 1 ]
</pre> 
     </div> 
    </div> 
    <p>What should not be done is to compromise the ratios for readability. For instance, if we want to encode probabilities of <i>1/3</i>, we should <b>NOT</b> encode them as:</p> 
    <div class="source"> 
     <div class="source"> 
      <pre>[ 0.33, 0.34, 0.33]
</pre> 
     </div> 
    </div> 
   </div> 
   <div class="section"> 
    <h5 id="arandom_ns_features">(random ns) features</h5> 
    <p><tt>features</tt> is an array of strings, where each string contains an Aloha feature specification. Each of these strings should just contain a variable definition. These features are used to create a hash on which the pseudo-randomness is based. It can be thought of as the <a class="externalLink" href="https://en.wikipedia.org/wiki/Statistical_unit">statistical unit</a> for the experiment being run.</p> 
    <p>An example value might be: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>[ &quot;${profile.user_id}&quot;, &quot;1&quot; ] 
</pre> 
     </div> 
    </div> 
    <p>where the second element, <i>1</i>, acts as a <a class="externalLink" href="https://en.wikipedia.org/wiki/Salt_(cryptography)">hash salt</a>. When using unique hash salts for every hash, one can avoid interaction in multiple hashes. For more information on salting including an example of issues that can arise, see <a class="externalLink" href="https://deaktator.github.io/presentations/prob-testing/#/10">Salts and Seeds</a> in <a class="externalLink" href="https://deaktator.github.io/presentations/prob-testing">Testing in an Unsure World</a> by <a class="externalLink" href="https://deaktator.github.io">Ryan Deak</a>.</p> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aDT_JSON_Examples">(DT) JSON Examples</h3> 
  <div class="section"> 
   <h4 id="aDT_One_Node_Tree_Example">(DT) One Node Tree Example</h4> 
   <p>The simplest tree would be a one node tree that is equivalent to a <a href="#Constant_model">Constant model</a>:</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DecisionTree&quot;,
  &quot;modelId&quot;: {&quot;id&quot;: 0, &quot;name&quot;: &quot;one node tree&quot;},
  &quot;returnBest&quot;: false,
  &quot;missingDataOk&quot;: false,
  &quot;nodes&quot;: [ { &quot;id&quot;: 1, &quot;value&quot;: 1 } ]
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_Three_Node_Tree_Example">(DT) Three Node Tree Example</h4> 
   <p>A basic tree with one split can be encoded as follows (deeper trees can just repeat the pattern). It will output the string “<i>short</i>” when the height is less than 66 (<i>presumably inches</i>). If height is greater than or equal to 66, “<i>tall</i>” is returned. Note that the <tt>value</tt> field is related to the model output type so this model will only parse when the model output type is <tt>String</tt>.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DecisionTree&quot;,
  &quot;modelId&quot;: {&quot;id&quot;: 0, &quot;name&quot;: &quot;height decision tree&quot;},
  &quot;returnBest&quot;: false,
  &quot;missingDataOk&quot;: false,
  &quot;nodes&quot;: [ 
    { 
      &quot;id&quot;: 1, 
      &quot;value&quot;: &quot;This value won't be returned b/c returnBest and missingDataOk are both false.&quot;,
      &quot;selector&quot;: { 
        &quot;selectorType&quot;: &quot;linear&quot;,
        &quot;predicates&quot;: [ &quot;${profile.height} &lt; 66&quot;, &quot;true&quot; ],
        &quot;children&quot;: [ 2, 3 ]
      }
    },
    { &quot;id&quot;: 2, &quot;value&quot;: &quot;short&quot; },
    { &quot;id&quot;: 3, &quot;value&quot;: &quot;tall&quot; }
  ]
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_Random_Branching_Example">(DT) Random Branching Example</h4> 
   <p>In the following example, we have a randomized split based on user id where 90% of the time, the value 1 is returned and 10% of the time, -1 is returned. If the user ID is missing, the output value will be 0. This is just for illustration purposes. Usually, you’ll want to add a constant salt to <tt>features</tt> like <tt>[ &quot;${profile.user_id}&quot;, &quot;1&quot; ]</tt>.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DecisionTree&quot;,
  &quot;modelId&quot;: {&quot;id&quot;: 0, &quot;name&quot;: &quot;90/10 random split&quot;},
  &quot;returnBest&quot;: true,
  &quot;missingDataOk&quot;: false,
  &quot;nodes&quot;: [ 
    { 
      &quot;id&quot;: 1, 
      &quot;value&quot;: 0,
      &quot;selector&quot;: { 
        &quot;selectorType&quot;: &quot;random&quot;,
        &quot;features&quot;: [ &quot;${profile.user_id}&quot; ],
        &quot;children&quot;: [ 2, 3 ],
        &quot;probabilities&quot;: [ 0.9, 0.1 ]
      }
    },
    { &quot;id&quot;: 2, &quot;value&quot;: 1 },
    { &quot;id&quot;: 3, &quot;value&quot;: -1 }
  ]
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aDT_Short-Circuit_Random_Branching_Example">(DT) Short-Circuit Random Branching Example</h4> 
   <p>As was mentioned above, you could have a situation where you want to do something randomly with some probability by making the <tt>children</tt> array 1 element shorter than the <tt>probabilities</tt> array. Let’s say that we want to do the same thing as in the previous example but are willing to give users missing a user ID a negative one. This allows us to essentially reuse the root node for randomization and missing data purposes. We can write that model as follows:</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DecisionTree&quot;,
  &quot;modelId&quot;: {&quot;id&quot;: 0, &quot;name&quot;: &quot;90/10 random split, user missing id get -1.&quot;},
  &quot;returnBest&quot;: true,
  &quot;missingDataOk&quot;: false,
  &quot;nodes&quot;: [ 
    { 
      &quot;id&quot;: 1, 
      &quot;value&quot;: -1,
      &quot;selector&quot;: { 
        &quot;selectorType&quot;: &quot;random&quot;,
        &quot;features&quot;: [ &quot;${profile.user_id}&quot; ],
        &quot;children&quot;: [ 2 ],
        &quot;probabilities&quot;: [ 0.9, 0.1 ]
      }
    },
    { &quot;id&quot;: 2, &quot;value&quot;: 1 }
  ]
}
</pre> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Double-to-Long_model">Double-to-Long model</h2> 
 <p>The Double-to-Long model provides an <a class="externalLink" href="https://en.wikipedia.org/wiki/Affine_transformation">affine transformation</a> from Double values to Long values. It works by applying the following transformation: </p> 
 <p><i>v</i> = <i>scale</i> &times; <i>submodel value</i> + <i>translation</i><br /><i>v</i>′ = <i>IF round THEN</i> round(<i>v</i>) <i>ELSE</i> floor(<i>v</i>)<br /><i>output</i> = max(<i>clampUpper</i>, min(<i>v</i>′, <i>clampUpper</i>))</p> 
 <p>This model is useful for <a class="externalLink" href="http://www.eharmony.com">eHarmony</a>-specific purposes, but others may find it useful as well. </p> 
 <div class="section"> 
  <h3 id="aDtL_JSON_Fields">(DtL) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aDtL_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aDtL_submodel">submodel</a></td> 
     <td><b>Model<sup>*</sup></b></td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aDtL_scale">scale</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>1</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aDtL_translation">translation</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>0</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aDtL_clampLower">clampLower</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>-∞</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aDtL_clampUpper">clampUpper</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>∞</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aDtL_round">round</a></td> 
     <td>Boolean</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>false</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aDtL_JSON_Field_Descriptions">(DtL) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aDtL_modelType">(DtL) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>DoubleToLong</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_submodel">(DtL) submodel</h4> 
   <p><tt>submodel</tt> must either be a JSON object containing an Aloha model or it can be a JSON object with exactly one field, <tt>import</tt> whose associated value is a JSON string containing an <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/filesystems.html">Apache VFS</a> URL. For instance: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{ &quot;import&quot;: &quot;/path/to/aloha/model.json&quot; }
</pre> 
    </div> 
   </div> 
   <p>Either way, the submodel is expected to be a model that takes the same input type as the Double-to-Long model itself and the submodel should have an output type of Double. The output to of the Double-to-Long model is obviously expected to be a 64-bit long-valued integer. </p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_scale">(DtL) scale</h4> 
   <p><tt>scale</tt> is the multiplier in the affine transformation. It can be any 64-bit float. When not supplied, the default value will be 1.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_translation">(DtL) translation</h4> 
   <p><tt>translation</tt> is the additive term in the affine transformation. It can be any 64-bit float. When not supplied, the default value will be 0.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_clampLower">(DtL) clampLower</h4> 
   <p><tt>clampLower</tt> is the lower <a class="externalLink" href="https://en.wikipedia.org/wiki/Clamping_(graphics)">clamp</a> value. It is a 64-bit long-valued int. When not supplied, the default value will be <tt>-9,223,372,036,854,775,808</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_clampUpper">(DtL) clampUpper</h4> 
   <p><tt>clampUpper</tt> is the upper <a class="externalLink" href="https://en.wikipedia.org/wiki/Clamping_(graphics)">clamp</a> value. It is a 64-bit long-valued int. When not supplied, the default value will be <tt>9,223,372,036,854,775,807</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_round">(DtL) round</h4> 
   <p><tt>round</tt> is a Boolean that determines whether the affine-transformed value should be rounded (<tt>true</tt>) or <a class="externalLink" href="https://en.wikipedia.org/wiki/Floor_and_ceiling_functions">floored</a> (<tt>false</tt>). </p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aDtL_JSON_Examples">(DtL) JSON Examples</h3> 
  <div class="section"> 
   <h4 id="aDtL_Minimal_Example">(DtL) Minimal Example</h4> 
   <p>A double-to-long model whose submodel is a constant model returning 5.5. The outer model floors <i>5.5</i> to the 64-bit long value <i>5</i>.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DoubleToLong&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
  &quot;submodel&quot;: {
    &quot;modelType&quot;: &quot;Constant&quot;,
    &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;Constant model returning 5.5&quot; },
    &quot;value&quot;: 5.5
  }
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aDtL_Full_Example">(DtL) Full Example</h4> 
   <p>A double-to-long model whose submodel is a constant model returning <tt>-13</tt>. The outer model multiplies by <tt>-0.5</tt>, adds <tt>2</tt>, rounds, then takes the min of <tt>clampUpper</tt> (<tt>8</tt>) and <tt>9</tt>, which comes out to <tt>8</tt>.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;DoubleToLong&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
  &quot;clampLower&quot;: 6,
  &quot;clampUpper&quot;: 8,
  &quot;scale&quot;: -0.5,
  &quot;translation&quot;: 2,
  &quot;round&quot;: true,
  &quot;submodel&quot;: {
    &quot;modelType&quot;: &quot;Constant&quot;,
    &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;Constant model returning -13&quot; },
    &quot;value&quot;: -13
  }
}
</pre> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Error_model">Error model</h2> 
 <p>An error model returns an error. This is not the same as throwing an exception. Error models return values.</p> 
 <div class="section"> 
  <h3 id="aE_JSON_Fields">(E) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aE_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aE_errors">errors</a></td> 
     <td>Array</td> 
     <td>String</td> 
     <td>true</td> 
     <td>Array[ &quot;Error with unspecified reason.&quot; ]</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aE_JSON_Field_Descriptions">(E) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aE_modelType">(E) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>Error</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aE_errors">(E) errors</h4> 
   <p><tt>errors</tt> is an array of error strings to provide. This is an optional parameter. An empty array is permitted. </p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aE_JSON_Examples">(E) JSON Examples</h3> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;Error&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
}
</pre> 
   </div> 
  </div> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;Error&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
  &quot;errors&quot;: [ &quot;error 1&quot;, &quot;error 2&quot; ]
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Error-swallowing_model">Error-swallowing model</h2> 
 <p>Error swallowing model makes an attempt to trap exceptions and return them as errors instead. While this is not foolproof, it was tested against <a class="externalLink" href="https://deaktator.github.io/2015/08/07/can-your-exception-handling-code-handle-the-schrodingerexception-juggernaut/">SchrodingerException</a>, an exception specifically designed to be as harmful as possible. The implementation uses <tt>scala.util.Try</tt> which means errors that are caught are dictated by <a class="externalLink" href="https://github.com/scala/scala/blob/v2.10.3/src/library/scala/util/control/NonFatal.scala">scala.util.control.NonFatal</a>.</p> 
 <div class="section"> 
  <h3 id="aES_JSON_Fields">(ES) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aES_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aES_submodel">submodel</a></td> 
     <td><b>Model<sup>*</sup></b></td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aES_recordErrorStackTraces">recordErrorStackTraces</a></td> 
     <td>Boolean</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>true</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aES_JSON_Field_Descriptions">(ES) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aES_modelType">(ES) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>ErrorSwallowingModel</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aES_submodel">(ES) submodel</h4> 
   <p><tt>submodel</tt> must either be a JSON object containing an Aloha model or it can be a JSON object with exactly one field, <tt>import</tt> whose associated value is a JSON string containing an <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/filesystems.html">Apache VFS</a> URL. For instance: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{ &quot;import&quot;: &quot;/path/to/aloha/model.json&quot; }
</pre> 
    </div> 
   </div> 
   <p>Either way, the submodel is expected to be a model with the same input and output type as the Error-swallowing model itself.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aES_recordErrorStackTraces">(ES) recordErrorStackTraces</h4> 
   <p><tt>recordErrorStackTraces</tt> is a boolean indicating whether to record stack traces in the returned error.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aES_JSON_Examples">(ES) JSON Examples</h3> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;ErrorSwallowingModel&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;0&quot; },
  &quot;recordErrorStackTraces&quot;: true,
  &quot;submodel&quot;: {
    &quot;modelType&quot;: &quot;Regression&quot;,
    &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;1&quot; },
    &quot;features&quot;: {
      &quot;evil_feature&quot;: &quot;throw new RuntimeException&quot;
    },
    &quot;weights&quot;: {}
  }
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Model_decision_tree_model">Model decision tree model</h2> 
 <p>Model decision tree models are just like <a href="#Decision_tree_model">Decision tree models</a> exception that the <tt>value</tt> field must either be a JSON object containing an Aloha model or it can be a JSON object representing a model import. For instance: </p> 
 <div class="source"> 
  <div class="source"> 
   <pre>{ &quot;import&quot;: &quot;/path/to/aloha/model.json&quot; }
</pre> 
  </div> 
 </div> 
 <p>where <tt>import</tt> is a JSON string containing an <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/filesystems.html">Apache VFS</a> URL. </p> 
 <p>The submodels, input, and output types are expected to be the same as the input and output type of the model decision tree model. The model works by using the decision tree algorithm to select a node containing a model, and then it applies the submodel it finds in the node to the same input data that was passed to the decision tree. </p> 
 <p>For more information, see the section on <a href="#Decision_tree_model">Decision tree models</a>.</p> 
</div> 
<div class="section"> 
 <h2 id="Regression_model">Regression model</h2> 
 <p>The regression model implementation in Aloha is a <a class="externalLink" href="https://en.wikipedia.org/wiki/Sparse_matrix">sparse</a> <a class="externalLink" href="https://en.wikipedia.org/wiki/Polynomial_regression">polynomial regression</a> model. This is a superset of and therefore subsumes <a class="externalLink" href="https://en.wikipedia.org/wiki/Linear_regression">linear regression</a> models.</p> 
 <div class="section"> 
  <h3 id="aR_JSON_Fields">(R) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aR_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aR_features">features</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aR_weights">weights</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aR_higherOrderFeatures">higherOrderFeatures</a></td> 
     <td>Array</td> 
     <td>Object</td> 
     <td>false</td> 
     <td>Empty Array</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aR_spline">spline</a></td> 
     <td>Array</td> 
     <td>Object</td> 
     <td>false</td> 
     <td>Empty Array</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aR_numMissingThreshold">numMissingThreshold</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>∞</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aR_JSON_Field_Descriptions">(R) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aR_modelType">(R) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>Regression</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aR_features">(R) features</h4> 
   <p><tt>features</tt> is the map of features that are included in the model. The keys in the <tt>features</tt> represent the feature names; the values can take on one of two forms. They can either be a String or a JSON object. If they are a JSON object, they must have the following format: </p> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#aR_feature_spec">spec</a></td> 
      <td>String</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aR_feature_defVal">defVal</a></td> 
      <td>Array</td> 
      <td>Array (2 elements. 0: (String) feature name, 1: (Number) feature value)</td> 
      <td>false</td> 
      <td>Empty Array</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="aR_feature_spec">(R) feature spec</h5> 
    <p><tt>spec</tt> contains an Aloha feature specification. These feature specifications produce functions whose input type is the same as the regression model’s input type and the output type is an iterable collection of (<i>String</i>, <i>Double</i>) key-value pairs. Specifically, the Scala type is <tt>scala.collection.Iterable[(String, Double)]</tt>. An example of such a <tt>spec</tt> string is:</p> 
    <div class="source"> 
     <div class="source"> 
      <pre>&quot;Seq((\&quot;\&quot;, ${profile.height}))&quot;
</pre> 
     </div> 
    </div> 
    <p>This creates one key-value pair whose <i>key</i> is the empty string and whose <i>value</i> is the height extract from a profile. One might ask, “<i>why would the key be the empty string?</i>” The answer is that the keys are prepended with the feature name. So, for instance, the above <i>spec</i> string might be included in a feature as follows: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;features&quot;: {
    &quot;height&quot;: { &quot;spec&quot;: &quot;Seq((\&quot;\&quot;, ${profile.height}))&quot; }
  }
  ...
}
</pre> 
     </div> 
    </div> 
    <p>Given the above model, let’s say the <tt>profile.height</tt> yields a value of <i>66</i>. Then the feature key-value pairs produced would be: { <tt>(&quot;height&quot;, 66)</tt> }.</p> 
    <p>There is a lot of supporting code available to the Aloha user when importing <tt>com.eharmony.aloha.feature.BasicFunctions._</tt>. Among these is an implicit conversion from numeric types to sequences of key-value pairs. This allows the user to write the previously mentioned Aloha function specification as: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>&quot;${profile.height}&quot;
</pre> 
     </div> 
    </div> 
    <p>Aloha will take care of converting it to:</p> 
    <div class="source"> 
     <div class="source"> 
      <pre>&quot;Seq((\&quot;\&quot;, ${profile.height}))&quot;
</pre> 
     </div> 
    </div> 
    <p>assuming <tt>profile.height</tt> is an appropriate numeric type.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aR_feature_defVal">(R) feature defVal</h5> 
    <p><b>NOTE</b>: <a class="externalLink" href="https://deaktator.github.io">Ryan Deak</a>, author of Aloha has expressed a personal distaste for the use of this feature. It can however create better models at the cost of readability and error reporting.</p> 
    <p><tt>defVal</tt> is the value that is returned if the <tt>spec</tt> references a variable whose presence is <i>optional</i> and whose value is not present for the current model input. As with the Iterable of key-value pairs produced by the function created by <tt>spec</tt>, keys will have the <i>feature name</i> prepended in the final feature value (see below for an example). </p> 
    <p><tt>defVal</tt> is a JSON Array of Arrays. The inner Array should contain a String followed by a Number. For instance, you may want to use something like the following: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>[[&quot;=UNKNOWN&quot;, 1]]
</pre> 
     </div> 
    </div> 
    <p><a class="externalLink" href="http://www.eharmony.com">eHarmony</a> uses this in a lot of models. Let’s put this into context: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;features&quot;: {
    &quot;height&quot;: { &quot;spec&quot;: &quot;Seq((\&quot;\&quot;, ${profile.height}))&quot;, &quot;defVal&quot;: [[&quot;=UNKNOWN&quot;, 1]] }
  }
  ...
}
</pre> 
     </div> 
    </div> 
    <p>and imagine <tt>profile.height</tt> is an optional variable that is not present in the current model input. Then the model can’t produce the key-value for <i>height</i> feature and defaults to using <tt>defVal</tt> to produce: { <tt>(&quot;height=UNKNOWN&quot;, 1)</tt> }. The reason we use the value <i>1</i> is that this is exactly the form of an <a class="externalLink" href="https://en.wikipedia.org/wiki/Dummy_variable_(statistics)">indicator variable</a>. That way, the regression model can have an associated weight in the <b>β</b> vector.</p> 
    <p>There is a consequence of providing a <tt>defVal</tt>. When the <tt>defVal</tt> field is provided and its value is the non-empty Array, this will affect the reporting of the number of missing features. For more information, see the <a href="#aR_numMissingThreshold">numMissingThreshold</a> section. </p> 
   </div> 
   <div class="section"> 
    <h5 id="aR_spec_as_a_String">(R) spec (as a String)</h5> 
    <p>As was mentioned above, features values in the regression model JSON can either be represented as a String or Object, the Object case is shown above. If you don’t provide a <tt>defVal</tt> in the above object, the specification Object can be replaced with just the <tt>spec</tt> value. For instance, the example from above: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;features&quot;: {
    &quot;height&quot;: { &quot;spec&quot;: &quot;Seq((\&quot;\&quot;, ${profile.height}))&quot; }
  }
  ...
}
</pre> 
     </div> 
    </div> 
    <p>could be rewritten as: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;features&quot;: {
    &quot;height&quot;: &quot;Seq((\&quot;\&quot;, ${profile.height}))&quot;
  }
  ...
}
</pre> 
     </div> 
    </div> 
    <p>and with what we learned about imports, if <tt>com.eharmony.aloha.feature.BasicFunctions._</tt> is imported, the JSON can be simplified further to: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;features&quot;: {
    &quot;height&quot;: &quot;${profile.height}&quot;
  }
  ...
}
</pre> 
     </div> 
    </div> 
    <p>This is easier to read and write and more aesthetically pleasing in general.</p> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aR_weights">(R) weights</h4> 
   <p><tt>weights</tt> is a representation of the <i>first-order</i> feature weights in the regression <b>β</b> vector. By <i>first-order</i>, we mean terms of <a class="externalLink" href="https://en.wikipedia.org/wiki/Degree_of_a_polynomial">degree</a> <i>1</i> in the <a class="externalLink" href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a> expression which is being regressed in the model.</p> 
   <p><tt>weights</tt> is a JSON Object where the keys are the same as the keys produced in the feature map. The values are the weights associated with the each feature value. </p> 
   <p><b>NOTE</b>: Only if the feature values (the numbers in the <a href="#aR_features">feature</a> key-value pairs) are <a class="externalLink" href="https://en.wikipedia.org/wiki/Standard_score#Calculation_from_raw_score">standardized</a>, can one infer feature importance from the magnitude of the weight values. This is because if the weights are not <a class="externalLink" href="https://en.wikipedia.org/wiki/Standard_score#Calculation_from_raw_score">standardized</a>, the scales of the feature values will differ and the weights will adapt to these scales.</p> 
   <p>An example of weights is: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  ...
  &quot;weights&quot;: {
    &quot;height&quot;: 1.23,
    &quot;weight&quot;: -2.34
  }
  ...
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aR_higherOrderFeatures">(R) higherOrderFeatures</h4> 
   <p><tt>higherOrderFeatures</tt> encodes the weights associated with terms in the <a class="externalLink" href="https://en.wikipedia.org/wiki/Polynomial">polynomial</a> expression with <a class="externalLink" href="https://en.wikipedia.org/wiki/Degree_of_a_polynomial">degree</a> greater than <i>1</i>. This is optional and is used for <a class="externalLink" href="https://en.wikipedia.org/wiki/Polynomial_regression">polynomial regression</a> models but is not necessary for <a class="externalLink" href="https://en.wikipedia.org/wiki/Linear_regression">linear regression</a> models. It is an <i>optional</i> field. An example looks like: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  &quot;features&quot;: {
    &quot;m_ht_lt_63&quot;: &quot;ind(${male.height} &lt; 63)&quot;,
    &quot;f_ht_gt_66&quot;: &quot;ind(66 &lt; ${female.height})&quot;,
  },
  ...
  &quot;higherOrderFeatures&quot;: [
    { 
      &quot;wt&quot;: -5.1, 
      &quot;features&quot;: { 
        &quot;m_ht_lt_63&quot;: [&quot;m_ht_lt_63=true&quot;], 
        &quot;f_ht_gt_66&quot;: [&quot;f_ht_gt_66=true&quot;] 
      }
    },
    { 
      &quot;wt&quot;: 1.2,
      &quot;features&quot;: {
        &quot;m_ht_lt_63&quot;: [&quot;m_ht_lt_63=false&quot;],
        &quot;f_ht_gt_66&quot;: [&quot;f_ht_gt_66=false&quot;]
      }
    }
  ]
}
</pre> 
    </div> 
   </div> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#aR_higherOrderFeatures_wt">wt</a></td> 
      <td>Number</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aR_higherOrderFeatures_features">features</a></td> 
      <td>Object</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
    </tbody> 
   </table> 
   <p>Given <tt>features</tt> with feature names “<i>m_ht_lt_63</i>” and “<i>f_ht_gt_66</i>”, where “<i>m_ht_lt_63</i>” is an indicator variable meaning male in a <a class="externalLink" href="https://en.wikipedia.org/wiki/Dyad_(sociology)">dyad</a> has a height of less than 63 inches and “<i>f_ht_gt_66</i>” means the female’s height is greater than 66 inches, we see that when the male is on the shorter side and the female is taller, this has a disproportionally large negative effect versus when the male is either not that much shorter (≤ 3 inches) or is taller than the the female.</p> 
   <div class="section"> 
    <h5 id="aR_higherOrderFeatures_wt">(R) higherOrderFeatures wt</h5> 
    <p>We can tell this because the <tt>wt</tt> field in each higher-order features. This is the weight associated with the <b>β</b> for the feature. Within the features</p> 
   </div> 
   <div class="section"> 
    <h5 id="aR_higherOrderFeatures_features">(R) higherOrderFeatures features</h5> 
    <p><tt>features</tt> is a map where the keys are the feature names from the top-level <a href="#aR_features">features</a> map in the regression model. The value associated with a key is a non-empty Array containing the <b>feature keys</b> from the features created by the top-level <a href="#aR_features">features</a> map. That is, when a feature function produces the Iterable of (<i>String</i>, <i>Double</i>) key-value pairs, the <i>String</i> in the first index of the tuple is the String that goes in this Array. It is possible to have Arrays of length larger than two. This will happen most commonly occurs when the term of interest in the polynomial is some variable raised to a power. </p> 
    <p>For instance, imagine someone throwing a ball 80 mph (35.7632 <i>m</i>/<i>s</i>) at a 30&deg; angle with a release point 8.25ft (2.5146 <i>m</i>) off the ground. The vertical velocity component is 17.8816 <i>m</i>/<i>s</i> = 0.5 &times; 35.7632. Using the equation from <a class="externalLink" href="https://en.wikipedia.org/wiki/Classical_mechanics">classical mechanics</a>: </p> 
    <p><i>h</i>(<i>t</i>) = 1/2<i>gt</i><sup>2</sup> + <i>v</i><sub>0</sub><i>t</i> + <i>h</i><sub>0</sub> &nbsp; &nbsp; Where <i>g</i> = -9.8 <i>m</i>/<i>s</i> </p> 
    <p>the height of the ball in meters could be encoded as:</p> 
    <div class="source"> 
     <div class="source"> 
      <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;80mph throw at 30 degree angle&quot; },
  &quot;features&quot;: {
    &quot;intercept&quot;: &quot;intercept&quot;,
    &quot;time&quot;: &quot;${time}&quot;
  },
  &quot;weights&quot;: {
    &quot;intercept&quot;: 2.5146,
    &quot;time&quot;: 17.8816
  },
  &quot;higherOrderFeatures&quot;: [
    { &quot;wt&quot;: -4.9, &quot;features&quot;: { &quot;time&quot;: [ &quot;time&quot;, &quot;time&quot; ] } } 
  ]
}
</pre> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aR_spline">(R) spline</h4> 
   <p><tt>spline</tt> is an optional field representing a <a class="externalLink" href="https://en.wikipedia.org/wiki/Spline_(mathematics)">spline</a> function. The spline is applied to the inner product of the feature vector, <b>X</b> and the <b>&amp;betal</b> vector (<b>Xβ</b>); and acts like an <a class="externalLink" href="https://en.wikipedia.org/wiki/Generalized_linear_model#Link_function">inverse link function</a> in <a class="externalLink" href="https://en.wikipedia.org/wiki/Generalized_linear_model">GLM</a>s. The reason a spline is provided rather than an explicit link is that oftentimes we want to <a class="externalLink" href="https://en.wikipedia.org/wiki/Calibration_(statistics)">calibrate</a> our classifiers to ensure that the class probabilities yield accurate estimates. For more information see <a class="externalLink" href="http://cseweb.ucsd.edu/~elkan/">Charles Elkan</a>’s and <a class="externalLink" href="http://www2.ic.uff.br/~bianca/">Bianca Zadrozny</a>’s papers on model calibration or checkout Jan Hendrik Metzen’s <a class="externalLink" href="https://jmetzen.github.io/2015-04-14/calibration.html">blog post on calibration</a> for a nice explanation.</p> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#aR_spline_min">min</a></td> 
      <td>Number</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aR_spline_max">max</a></td> 
      <td>Number</td> 
      <td>N / A</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#aR_spline_knots">knots</a></td> 
      <td>Array</td> 
      <td>Number</td> 
      <td>true</td> 
      <td>N / A</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="aR_spline_min">(R) spline min</h5> 
    <p><tt>min</tt> is the minimum value in the <a class="externalLink" href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> of the spline. Values less than <tt>min</tt> will be <a class="externalLink" href="https://en.wikipedia.org/wiki/Clamping_(graphics)">clamped</a>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aR_spline_max">(R) spline max</h5> 
    <p><tt>max</tt> is the minimum value in the <a class="externalLink" href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> of the spline. Values greater than <tt>max</tt> will be <a class="externalLink" href="https://en.wikipedia.org/wiki/Clamping_(graphics)">clamped</a>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aR_spline_knots">(R) spline knots</h5> 
    <p><tt>knots</tt> defines the <a class="externalLink" href="https://en.wikipedia.org/wiki/Piecewise_linear_function">piecewise linear</a> <a class="externalLink" href="https://en.wikipedia.org/wiki/Spline_(mathematics)">spline</a>. The knots are the values of the <a class="externalLink" href="https://en.wikipedia.org/wiki/Codomain">codmain</a>. The associated <a class="externalLink" href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> values can be calculated from the <tt>min</tt>, <tt>max</tt>, and size of the <tt>knots</tt> Array. The size of <tt>knots</tt> must be at least two, unless in the special case <tt>min</tt> equals <tt>max</tt>, in which case knots is expected to contain <i>exactly</i> one element.</p> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aR_numMissingThreshold">(R) numMissingThreshold</h4> 
   <p><tt>numMissingThreshold</tt> is an optional integral value. When supplied, if the number of <a href="#aR_features">features</a> that yield empty Iterables (<i>size zero</i>) <b>exceeds</b> <tt>numMissingThreshold</tt>, then an error rather than a score will be returned. </p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aR_JSON_Examples">(R) JSON Examples</h3> 
  <div class="section"> 
   <h4 id="aR_Basic_Example">(R) Basic Example</h4> 
   <p>This is the most basic regression model there is, just an intercept term:</p> 
   <blockquote> 
    <p>0.5 = <b>βX</b> = [0.5]<sup>T</sup>[1]<sup>T</sup></p> 
   </blockquote> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;basic example&quot; },
  &quot;features&quot;: { &quot;intercept&quot;: &quot;intercept&quot; },
  &quot;weights&quot;: { &quot;intercept&quot;: 0.5 }
}
</pre> 
    </div> 
   </div> 
   <p>There is a little bit going on here behind the scenes. The <tt>intercept</tt> function that appears as the sole <i>value</i> in the <tt>features</tt> map is a special function that is included when importing <tt>com.eharmony.aloha.feature.BasicFuncions._</tt>. It is in the <tt>com.eharmony.aloha.feature.Intercept</tt> trait that is mixed into <tt>BasicFuncions</tt>. What this function does is create one key-value pair: <tt>(&quot;&quot;, 1.0)</tt>. Then, as has been mentioned before, the feature name is prepended to the key, so the final key-value pair is <tt>(&quot;intercept&quot;, 1.0)</tt>. The <tt>1.0</tt> represents the <a class="externalLink" href="https://en.wikipedia.org/wiki/Artificial_neuron#Basic_structure">bias term</a> and the associated <tt>intercept</tt> in the <tt>weights</tt> map represents the model’s output when all <a class="externalLink" href="https://en.wikipedia.org/wiki/Covariate">covariate</a> data is omitted.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aR_higherOrderFeatures_Example">(R) higherOrderFeatures Example</h4> 
   <p>This is repeated from the <a href="#aR_higherOrderFeatures_features">higherOrderFeatures features</a> section. It illusrates modeling the equation <i>h</i>(<i>t</i>) = 1/2<i>gt</i><sup>2</sup> + <i>v</i><sub>0</sub><i>t</i> + <i>h</i><sub>0</sub>. See that section for more information.</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;Regression&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;80mph throw at 30 degree angle&quot; },
  &quot;features&quot;: {
    &quot;intercept&quot;: &quot;intercept&quot;,
    &quot;time&quot;: &quot;${time}&quot;
  },
  &quot;weights&quot;: {
    &quot;intercept&quot;: 2.5146,
    &quot;time&quot;: 17.8816
  },
  &quot;higherOrderFeatures&quot;: [
    { &quot;wt&quot;: -4.9, &quot;features&quot;: { &quot;time&quot;: [ &quot;time&quot;, &quot;time&quot; ] } } 
  ]
}
</pre> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Segmentation_model">Segmentation model</h2> 
 <p>Segmentation models take a submodel that returns a value with an imposed <a class="externalLink" href="https://en.wikipedia.org/wiki/Total_order">total ordering</a> and then create a <a class="externalLink" href="https://en.wikipedia.org/wiki/Partition_of_a_set">partition</a> on the set of values the submodel produces. The segmentation model maps elements in the same induced <a class="externalLink" href="https://en.wikipedia.org/wiki/Equivalence_class">equivalence class</a> to a label unique to each class.</p> 
 <div class="section"> 
  <h3 id="aS_JSON_Fields">(S) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aS_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aS_subModel"><b>subModel</b></a></td> 
     <td><b>Model<sup>*</sup></b></td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aS_subModelOutputType">subModelOutputType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aS_thresholds">thresholds</a></td> 
     <td>subModel Output</td> 
     <td><b>subModel Output</b></td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aS_labels">labels</a></td> 
     <td>Array</td> 
     <td><b>Output</b></td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aS_JSON_Field_Descriptions">(S) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aS_modelType">(S) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>Segmentation</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aS_subModel">(S) subModel</h4> 
   <p><tt>submodel</tt> must either be a JSON object containing an Aloha model or it can be a JSON object that represents the import of an external model. The <tt>import</tt> field has an associated value which is a JSON string containing an <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/filesystems.html">Apache VFS</a> URL. For instance: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>{ &quot;import&quot;: &quot;/path/to/aloha/model.json&quot; }
</pre> 
    </div> 
   </div> 
   <p>Either way, the submodel is expected to be a model that takes the same input type as the Segmentation model itself and the submodel should have an output type dictated by the <a href="#aS_subModelOutputType">subModelOutputType</a> value.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aS_subModelOutputType">(S) subModelOutputType</h4> 
   <p><tt>subModelOutputType</tt> determines the output type of the submodel. <tt>subModelOutputType</tt> must be one of:</p> 
   <ul> 
    <li>Byte</li> 
    <li>Short</li> 
    <li>Int</li> 
    <li>Long</li> 
    <li>Float</li> 
    <li>Double</li> 
    <li>String</li> 
   </ul> 
  </div> 
  <div class="section"> 
   <h4 id="aS_thresholds">(S) thresholds</h4> 
   <p><tt>thresholds</tt> is the set of values that partitions the space into intervals. It should be sorted according to the natural <a class="externalLink" href="https://en.wikipedia.org/wiki/Total_order">total ordering</a> associated with the output type of the submodel.<br />This Array must have one less element than the <tt>labels</tt> Array. If, for instance, the submodel produces a value “less than” the first value in <tt>thresholds</tt>, then the first element in <tt>labels</tt> is returned. If that’s not the case, the search continues until an element in <tt>thresholds</tt> is greater than the submodel output. If there is no such value, the last element in <tt>labels</tt> is returned.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aS_labels">(S) labels</h4> 
   <p><tt>labels</tt> contains the labels associated with each <a class="externalLink" href="https://en.wikipedia.org/wiki/Equivalence_class">equivalence class</a> induced by <tt>thresholds</tt>. The type of each label must be the same as the Segmentation model output type. <tt>labels</tt> must have one more element that <tt>thresholds</tt>. See <a href="#aS_thresholds">thresholds</a> section for more details.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aS_JSON_Examples">(S) JSON Examples</h3> 
  <p>The following shows a model whose output type is String, with a submodel that returns a value in { 1, 4, 5, 7 }.<br />The mapping from submodel value to Segmentation model value is: </p> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>subModel</th> 
     <th>Segmentation</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td>1</td> 
     <td>smallest</td> 
    </tr> 
    <tr class="a"> 
     <td>4</td> 
     <td>second smallest</td> 
    </tr> 
    <tr class="b"> 
     <td>5</td> 
     <td>second largest</td> 
    </tr> 
    <tr class="a"> 
     <td>7</td> 
     <td>largest</td> 
    </tr> 
   </tbody> 
  </table> 
  <div class="source"> 
   <div class="source"> 
    <pre>{
  &quot;modelType&quot;: &quot;Segmentation&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
  &quot;thresholds&quot;: [ 2, 5, 6 ],
  &quot;labels&quot;: [ &quot;smallest&quot;, &quot;second smallest&quot;, &quot;second largest&quot;, &quot;largest&quot; ],
  &quot;subModelOutputType&quot;: &quot;Int&quot;,
  &quot;subModel&quot;: {
    &quot;modelType&quot;: &quot;CategoricalDistribution&quot;,
    &quot;modelId&quot;: { &quot;id&quot;: 1, &quot;name&quot;: &quot;&quot; },
    &quot;features&quot;: [ &quot;${profile.id}&quot;, &quot;1&quot; ],
    &quot;probabilities&quot;: [ 0.25, 0.25, 0.25, 0.25 ] ,
    &quot;labels&quot;: [ 1, 4, 5, 7 ],
    &quot;missingOk&quot;: true
  }
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Vowpal_Wabbit_model">Vowpal Wabbit model</h2> 
 <p>The <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/wiki">Vowpal Wabbit</a> model provides the feature extraction capabilities of an Aloha native <a href="#Regression_model">Regression model</a>, but delegates to VW’s <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/tree/master/java">JNI layer</a> for prediction, which is much more powerful. Note that this shares a fair amount of code with <a href="#Regression_model">Regression model</a> so be sure to look at the docs there.</p> 
 <p><b>NOTE</b>: This model is in module <b>aloha-vw-jni</b>, not <b>aloha-core</b>. To use, be sure to include the proper maven dependency: </p> 
 <div class="source"> 
  <div class="source"> 
   <pre>&lt;dependency&gt;
  &lt;groupId&gt;com.eharmony&lt;/groupId&gt;
  &lt;artifactId&gt;aloha-vw-jni&lt;/artifactId&gt;
  &lt;version&gt;...&lt;/version&gt;
&lt;dependency&gt; 
</pre> 
  </div> 
 </div> 
 <p>VW does not need to be installed on the computer where the Aloha VW model is used. The VW JNI library contains operating system-specific versions of the VW library, so it will be included transitively when the <tt>aloha-vw-jni</tt> maven dependency is pulled in. Since VW is <b>not binary compatible across versions</b>, the trained VW binary model needs to be trained on the same VW version that is included in the <tt>aloha-vw-jni</tt> <a class="externalLink" href="https://github.com/eHarmony/aloha/blob/master/aloha-vw-jni/pom.xml">POM</a>. Make sure to look for this dependency.</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>&lt;dependency&gt;
 &lt;groupId&gt;com.github.johnlangford&lt;/groupId&gt;
 &lt;artifactId&gt;vw-jni&lt;/artifactId&gt;
 &lt;version&gt;[THIS VERSION NEEDS TO MATCH THE VW USED TO TRAIN THE MODEL]&lt;/version&gt;
&lt;dependency&gt;
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aVW_JSON_Fields">(VW) JSON Fields</h3> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead> 
    <tr class="a"> 
     <th>Field Name</th> 
     <th>JSON Type</th> 
     <th>JSON Subtype</th> 
     <th>Required</th> 
     <th>Default</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr class="b"> 
     <td><a href="#aVW_modelType">modelType</a></td> 
     <td>String</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td>modelId</td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aS_features">features</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aS_vw">vw</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aVW_namespaces">namespaces</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>true</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aVW_numMissingThreshold">numMissingThreshold</a></td> 
     <td>Number</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="b"> 
     <td><a href="#aVW_notes">notes</a></td> 
     <td>Array</td> 
     <td>String</td> 
     <td>false</td> 
     <td>N / A</td> 
    </tr> 
    <tr class="a"> 
     <td><a href="#aVW_spline">spline</a></td> 
     <td>Object</td> 
     <td>N / A</td> 
     <td>false</td> 
     <td>N / A</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
 <div class="section"> 
  <h3 id="aVW_JSON_Field_Descriptions">(VW) JSON Field Descriptions</h3> 
  <div class="section"> 
   <h4 id="aVW_modelType">(VW) modelType</h4> 
   <p><tt>modelType</tt> field must be <tt>VwJNI</tt>.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_features">(VW) features</h4> 
   <p>See <a href="#aR_features">Regression model features</a> for details.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_vw">(VW) vw</h4> 
   <p>The <tt>vw</tt> Object has two main components. The first component is a representation of the binary VW model, or “<i>initial regressor</i>” in VW terminology. This is the model parameterization. The second component is the set of parameters used by VW. This includes things like the link function, prediction ranges, skip grams, namespace interactions, regularization, etc. To see descriptions of these parameters, see the <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/wiki">VW wiki</a> or run: </p> 
   <div class="source"> 
    <div class="source"> 
     <pre>vw -h
</pre> 
    </div> 
   </div> 
   <table border="0" class="bodyTable table table-striped table-hover"> 
    <thead> 
     <tr class="a"> 
      <th>Field Name</th> 
      <th>JSON Type</th> 
      <th>JSON Subtype</th> 
      <th>Required</th> 
      <th>Default</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="b"> 
      <td><a href="#aVW_vw_creationTime">creationTime</a></td> 
      <td>Number</td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>number of milliseconds since <a class="externalLink" href="https://en.wikipedia.org/wiki/Unix_time">epoch</a> for current time.</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aVW_vw_model">model</a></td> 
      <td>String</td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#aVW_vw_modelUrl">modelUrl</a></td> 
      <td>String</td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="a"> 
      <td><a href="#aVW_vw_via">via</a></td> 
      <td>String with one of: &quot;<i>file</i>&quot;, &quot;<i>vfs1</i>&quot;, &quot;<i>vfs2</i>&quot;</td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>N / A</td> 
     </tr> 
     <tr class="b"> 
      <td><a href="#aVW_vw_params">params</a></td> 
      <td>String or Array of String</td> 
      <td>N / A</td> 
      <td>false</td> 
      <td>Empty String</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="section"> 
    <h5 id="aVW_vw_creationTime">(VW) vw creationTime</h5> 
    <p><tt>creationTime</tt> is optional and is used when copying the content of the binary VW model to the local disk on the computer where the Aloha model is run. When no value is supplied, the value will be set to <tt>java.lang.System.currentTimeMillis()</tt>.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aVW_vw_model">(VW) vw model</h5> 
    <p>Exactly one of <tt>model</tt> or <tt>modelUrl</tt> is required. When <tt>model</tt> is provided, it should be a string with the base64-encoded content of the binary VW model. For instance, this may be something like the string: </p> 
    <p>“<tt>BgAAADguMC4wAG0AAAAAAACAPxIAAAAAAAAAAAAAAAAAAAABAAAAAAA=</tt>”</p> 
    <p>which might come from: </p> 
    <div class="source"> 
     <div class="source"> 
      <pre>echo &quot;&quot; | vw -f model.vw 2&gt;/dev/null &amp;&amp; cat model.vw | base64 &amp;&amp; rm -f model.vw
</pre> 
     </div> 
    </div> 
   </div> 
   <div class="section"> 
    <h5 id="aVW_vw_modelUrl">(VW) vw modelUrl</h5> 
    <p>Exactly one of <tt>model</tt> or <tt>modelUrl</tt> is required. When <tt>modelUrl</tt> is provided, it should be a string contain an <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/filesystems.html">Apache VFS</a> URL. This is the location from which the content will be copied to the local disk.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aVW_vw_via">(VW) vw via</h5> 
    <p><tt>via</tt> is optional. It is a string and can be one of: <tt>file</tt>, <tt>vfs1</tt>, <tt>vfs2</tt>. It provides a way for Aloha users to use different versions of <a class="externalLink" href="https://commons.apache.org/proper/commons-vfs/">Apache VFS</a>. This is useful because VFS provides a common interface to different file systems. Since VFS provides a plugin architecture, different plugins might be available to different versions of VFS. For instance, the HDFS plugin eHarmony uses (at the time of this writing) is a VFS 1 plugin.</p> 
   </div> 
   <div class="section"> 
    <h5 id="aVW_vw_params">(VW) vw params</h5> 
    <p><tt>params</tt> is not required. It can either be specified as a string or an Array of strings (which are joined with a space in between each item). This is how VW parameters are specified. </p> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_namespaces">(VW) namespaces</h4> 
   <p>A JSON object representing a map from <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Input-format">namespace</a> names to an Array of feature names to be placed in that <a class="externalLink" href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Input-format">namespace</a>. For example:</p> 
   <div class="source"> 
    <div class="source"> 
     <pre>  &quot;features&quot;: {
    &quot;height_mm&quot;: &quot;${profile.height_cm} * 10&quot;
  },
  ...
  &quot;namespaces&quot;: {
    &quot;personal_features&quot;: [ &quot;height_mm&quot; ]
  }
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_numMissingThreshold">(VW) numMissingThreshold</h4> 
   <p>See <a href="#aR_numMissingThreshold">Regression model numMissingThreshold</a> for details.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_notes">(VW) notes</h4> 
   <p>This is just an optional Array of Strings for documentation purposes.</p> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_spline">(VW) spline</h4> 
   <p>See <a href="#aR_spline">Regression model spline</a> for details.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="aVW_JSON_Examples">(VW) JSON Examples</h3> 
  <div class="section"> 
   <h4 id="aVW_Base64_Encoded_Model_JSON_Example">(VW) Base64 Encoded Model JSON Example</h4> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;VwJNI&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;&quot; },
  &quot;features&quot;: {
    &quot;height_mm&quot;: &quot;Seq((\&quot;1800\&quot;, 1.0))&quot;
  },
  &quot;namespaces&quot;: {
    &quot;personal_features&quot;: [ &quot;height_mm&quot; ]
  },
  &quot;vw&quot;: {
    &quot;params&quot;: &quot;--quiet -t&quot;,
    &quot;model&quot;: &quot;[base64 encoded model string here]&quot;
  }
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_Model_URL_JSON_Example">(VW) Model URL JSON Example</h4> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;VwJNI&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;model name&quot; },
  &quot;features&quot;: {
    &quot;height_mm&quot;: &quot;Seq((\&quot;1800\&quot;, 1.0))&quot;
  },
  &quot;notes&quot;: [
    &quot;This is a note&quot;
  ],
  &quot;namespaces&quot;: {
    &quot;personal_features&quot;: [ &quot;height_mm&quot; ]
  },
  &quot;vw&quot;: {
    &quot;params&quot;: [&quot;--quiet&quot;, &quot;-t&quot;],
    &quot;model&quot;: &quot;file:///Users/xyz/model.vw&quot;
  }
}
</pre> 
    </div> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="aVW_Model_URL_via_vfs1_JSON_Example">(VW) Model URL via ‘vfs1’ JSON Example</h4> 
   <div class="source"> 
    <div class="source"> 
     <pre>{
  &quot;modelType&quot;: &quot;VwJNI&quot;,
  &quot;modelId&quot;: { &quot;id&quot;: 0, &quot;name&quot;: &quot;model name&quot; },
  &quot;features&quot;: {
    &quot;height_mm&quot;: &quot;Seq((\&quot;1800\&quot;, 1.0))&quot;
  },
  &quot;notes&quot;: [
    &quot;This is a note&quot;
  ],
  &quot;namespaces&quot;: {
    &quot;personal_features&quot;: [ &quot;height_mm&quot; ]
  },
  &quot;vw&quot;: {
    &quot;params&quot;: [&quot;--quiet&quot;, &quot;-t&quot;],
    &quot;model&quot;: &quot;hdfs://some/path/to/data&quot;,
    &quot;via&quot;: &quot;vfs1&quot;
  }
}
</pre> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="./" title="Home">Home</a>
						</li>
						<li >
							<a href="http://github.com/eharmony/aloha/" title="Code" class="externalLink">Code</a>
						</li>
						<li >
							<a href="release-notes.html" title="Release notes">Release notes</a>
						</li>
						<li class="nav-header">Maven Documentation</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">API Docs</li>
						<li >
							<a href="aloha-core/scaladocs/index.html" title="aloha-core">aloha-core</a>
						</li>
						<li >
							<a href="aloha-vw-jni/scaladocs/index.html" title="aloha-vw-jni">aloha-vw-jni</a>
						</li>
						<li >
							<a href="aloha-cli/scaladocs/index.html" title="aloha-cli">aloha-cli</a>
						</li>
						<li class="nav-header">Contribute</li>
						<li >
							<a href="http://github.com/eharmony/aloha/issues/" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="http://github.com/eharmony/aloha/" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li >
							<a href="contribute.html" title="Contribute">Contribute</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Dataset Examples</li>
						<li >
							<a href="eg/dataset/csv.html" title="CSV">CSV</a>
						</li>
						<li >
							<a href="eg/dataset/vw.html" title="VW Unlabeled">VW Unlabeled</a>
						</li>
						<li >
							<a href="eg/dataset/labeled_vw.html" title="VW Labeled">VW Labeled</a>
						</li>
						<li >
							<a href="eg/dataset/cb_vw.html" title="VW Bandit">VW Bandit</a>
						</li>
						<li >
							<a href="eg/dataset/libsvm.html" title="LIBSVM Unlabeled">LIBSVM Unlabeled</a>
						</li>
						<li >
							<a href="eg/dataset/labeled_libsvm.html" title="LIBSVM Labeled">LIBSVM Labeled</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">Aloha</span> is a scala-based feature generation and modeling framework.</blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2013-2015 <a href="http://eharmony.com">eHarmony</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 3.0.0. </span><span class="publishDate">Last Published: 2015-11-01. </span></p>
					</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src=".//js/lightbox.min.js"></script>
	<script src=".//js/reflow-scroll.js"></script>
	
<script src=".//js/highlight/highlight.pack.js"></script>
	<script src=".//js/reflow-skin.js"></script>

	</body>
</html>
